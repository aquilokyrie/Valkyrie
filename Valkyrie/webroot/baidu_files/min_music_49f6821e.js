F._setMod("musicplus");F._fileMap({"/js/min_music_8e28de64.js":["config","view/fm_view","mods_extend/baidu_fm_mod_extend","mngr/fm_data","mods/baidu_fm","fmplaycore/play_engine","mods_extend/baidu_fm_music_log","mods_extend/baidu_fm_player","mods_extend/baidu_fm_channel_panel","start/music_start"],"/css/music_6a92346d.css":["music_fm.css","skin_opacity.css"]});F._useConfig=true;F._firstScreenJS=F._firstScreenJS||[];F._firstScreenJS.push("/js/min_music_8e28de64.js");F.module("musicplus:view/fm_view",function(d,b,a){d("music_fm.css");var c=["","<div class='s-xman-baidu-fm'>","<div class='fm-wrap' style=''>","<div class='fm-pic "+($.isIE?($.browser.ie>9?"s-skin-opacity-background":""):"s-skin-opacity-background")+"'>",'<div id="s_fm_pic_img" class="img"></div>','<div class="fm-pic-mask"></div>',"</div>","<div class='fm-panel s-skin-opacity-background'>","<div class='play-panel'>","<div class='music-info'>","<span class='s-name'><a class='name' href='#' target='_blank' hidefocus=true>&nbsp;</a></span>","<span class='s-author'><a class='author' href='#' target='_blank' hidefocus=true>&nbsp;</a></span>","<div class='clear'></div>","<div class='process-bar'><div class='processing'></div></div>","<span class='time'>-0:00</span>","<a class='download-btn' href='#' hidefocus target='_blank'>下载</a>","</div>","<div class='music-ctrl'>","<ul>","<li class='ctrl-btn-onpic ctrl-btn'><a href='#' title='播放' onclick='return false' id='play-btn' class='play-btn pause' hidefocus=true></a></li>","<div style='overflow:hidden;height:0px;'></div>","<li class='ctrl-btn'><a href='#' title='播放' onclick='return false' id='play-btn' class='play-btn pause' hidefocus=true></a></li>","<li class='ctrl-btn'><a href='#' title='#{lovedTitle}' onclick='return false' id='love-btn' class='love-btn #{loved}' hidefocus=true></a></li>","<li class='ctrl-btn'><a href='#' title='不再播放' onclick='return false' id='hate-btn' class='hate-btn' hidefocus=true></a></li>","<li class='ctrl-btn'><a href='#' title='切歌' onclick='return false' id='next-btn' class='next-btn' hidefocus=true></a></li>","</ul>","</div>","<div class='volume-ctrl #{muted}'>","<a href='#' onclick='return false' hidefocus=true class='volume-open' title='调节音量'></a>","<div class='volume-panel'>","<div class='slider' style='height:#{userWidth}'></div>","<a href='#' style='bottom:#{userLeft}' onclick='return false' class='handle' hidefocus=true></a>","<a href='#' onclick='return false' hidefocus=true title='静音' class='mute'></a>","</div>","</div>","</div>","<div class='lrc-panel'>","<div class='lrc-panel-top'></div>","<a hidefocus href='http://music.baidu.com/' target='_blank' class='music-logo'></a>","<div class='lrc-wrap'>","<ul id='lrc_content'></ul>","</div>","<div class='lrc-info'></div>","<div class='lrc-scroll-ctrl'>","<div class='lrc-scroll-slider'></div>","</div>","</div>","</div>","<div class='change-panel s-skin-opacity-background'>","</div>","</div>","</div>"];b.init=function(g,i){var h=f(i.data.content);$("#"+g).html($.formatString(c.join(""),h));e(g,i.data)};var f=function(g){return{userWidth:(g.volume)+"%",userLeft:((g.volume)/100*52)+"px",loved:(g.id=="lovesongs")?"loved":"",lovedTitle:(g.id=="lovesongs")?"取消收藏":"收藏",muted:(g.volume==0)?"volume-muted":""}};var e=function(g,j){var i=$("#"+g);var h={};if(j){a.use("mods_extend/baidu_fm_mod_extend",function(k){k.mod.init({isNew:true,data:{id:j.content.id,name:j.content.name,list:j.content.list,volume:j.content.volume},dom:{songName:$("#"+g+" .name")[0],singerName:$("#"+g+" .author")[0],channelName:$("#"+g+" .current-channel")[0],musicCtrl:$("#"+g+" .ctrl-btn"),channelPnl:$("#"+g+" .change-panel")[0],musicTime:$("#"+g+" .time")[0],playPanel:$("#"+g+" .play-panel")[0],volumeCtrl:$("#"+g+" .volume-ctrl")[0],lrcPanel:$("#"+g+" .lrc-panel")[0],picShow:$("#s_fm_pic_img"),processBar:$("#"+g+" .processing"),downloadBtn:$("#"+g+" .download-btn"),lrcScrollPanel:$("#"+g+" .lrc-scroll-ctrl"),lrcScrollSlider:$("#"+g+" .lrc-scroll-slider")}})})}}});F.addLog("musicplus:mods_extend",{musicTime:"0300000004"});F.module("musicplus:mods_extend/baidu_fm_mod_extend",function(f,d,c){var g=g||{};g._createScriptTag=function(i,h,j){i.setAttribute("type","text/javascript");j&&i.setAttribute("charset",j);i.setAttribute("src",h);document.getElementsByTagName("head")[0].appendChild(i)};g._removeScriptTag=function(i){if(i.clearAttributes){i.clearAttributes()}else{for(var h in i){if(h!=="nodeName"&&h!=="parentNode"&&i.hasOwnProperty(h)){delete i[h]}}}if(i&&i.parentNode){i.parentNode.removeChild(i)}i=null};g.callByBrowser=function(h,n,p){var k=document.createElement("SCRIPT"),l=0,q=p||{},j=q.charset,o=n||function(){},m=q.timeOut||0,i;k.onload=k.onreadystatechange=function(){if(l){return}var r=k.readyState;if("undefined"==typeof r||r=="loaded"||r=="complete"){l=1;try{o();clearTimeout(i)}finally{k.onload=k.onreadystatechange=null;g._removeScriptTag(k)}}};if(m){i=setTimeout(function(){k.onload=k.onreadystatechange=null;g._removeScriptTag(k);q.onfailure&&q.onfailure()},m)}g._createScriptTag(k,h,j)};var b=new $.Strpx("font-size:14px;font-family:'Microsoft Yahei', '微软雅黑', '宋体', \\5b8b\\4f53, Tahoma, Arial, Helvetica, STHeiti"),e=new $.Strpx("font-size:20px;font-family:Microsoft Yahei,微软雅黑,SimHei,STHeiti,宋体, \\5b8b\\4f53, Tahoma, Arial, Helvetica");var a=function(){var h=this;this.jumpUrl={song:"http://music.baidu.com/song/",singer:"http://music.baidu.com/artist/"};this.isNew=true;this.isLoading=false;this.loadRealState=false;this.channelType=-1;this.playList=[];this.currentIndex=0;this.userVolume=50;this.currentChannel="";this.currentChannelName="";this.loadIndex=[];this.changeSuc=false;this.songClass=function(l,i,k,j){this.singer_id=l;this.song_id=i;this.song_name=k;this.singer_name=j;this.songLink="";this.lrcLink="";this.type=-1};this.modDom={};this.init=function(j){h.currentChannel=j.data.id;h.currentChannelName=j.data.name;h.channelType=-1;h.isNew=j.isNew;h.modDom=j.dom;h.processLen=229;h.userVolume=j.data.volume;h.playList[0]=[];var i=h;var k=function(){g.callByBrowser("http://fm.baidu.com/dev/api/?tn=playlist&special=flash&prepend=&format=json&id="+j.data.id+"&callback=packFmLoadSongs&_="+new Date().getTime(),function(){if(window.packFmSongsList.length>0){var n="";var l=window.packFmSongsList.length<10?window.packFmSongsList.length:10;for(var m=0;m<l;m++){n+=window.packFmSongsList[m].song_id;if(m<l-1){n+=","}}g.callByBrowser("http://music.baidu.com/data/music/fmlink?songIds="+n+"&callback=packFmLoadSongsMore&_="+new Date().getTime(),function(){S.each(window.packFmSongsList,function(o){i.playList[0].push(o)});i.listInit(j.data.id,j.data.name,0)},{charset:"utf-8",timeOut:100000,onfailure:function(){i.listInit(j.data.id,j.data.name,0);c.fire("musicTime",{timeOutType:"selectSong"})}})}else{j.data.id="public_tuijian_suibiantingting";j.data.channel_name="随便听听";i.init(j)}},{charset:"utf-8",timeOut:5000,onfailure:function(){k();c.fire("musicTime",{timeOutType:"songsList"})}})};k()};this.listInit=function(l,i,k){baidu.packFmCurrentChannel=l;if(h.playList[0].length<1){return}h.channelType=1;h.currentIndex=k;h.loadIndex[0]=h.currentIndex;h.playList[1]=h.playList[0];h.loadIndex[1]=h.playList[0].length<=10?0:10;var j=h.playList[h.channelType];h.renderMusicInfo(j[h.currentIndex]["song_name"],j[h.currentIndex]["song_id"],j[h.currentIndex]["singer_name"],j[h.currentIndex]["singer_id"],j[h.currentIndex].type,j[h.currentIndex].songPicBig,j[h.currentIndex].song_time,true);c.fire("fm_data_loaded")};this.renderMusicInfo=function(i,m,p,j,r,o,l,q){if(S.setAttr){S.setAttr(h.modDom.songName,"title",i);S.setAttr(h.modDom.singerName,"title",p)}h.modDom.picShow.css("background-image","").css("background-position","-280px 0");if(o){h.modDom.picShow.css("background-image","url("+decodeURIComponent(o)+")").css("background-position","center center")}var s=Math.floor(l/60),n=l%60;(s<10)&&(s="0"+s);(n<10)&&(n="0"+n);h.modDom.musicTime.innerHTML="-"+s+":"+n;var k=250;var t=348;p=" "+p;i=e.substringByPx(i,k,"...");p=b.substringByPx(p,t-e.getLengthPx(i),"...");h.modDom.downloadBtn.attr("href","http://music.baidu.com/song/"+m+"/download?fm=super");h.modDom.songName.innerHTML=i;h.modDom.songName.href=h.jumpUrl.song+m+"?from=fm";h.modDom.singerName.innerHTML=p;h.modDom.singerName.href=h.jumpUrl.singer+j.split(",")[0]+"?from=fm";var u=S.g("love-btn");if(r==0&&!S.hasClass(u,"loved")){S.addClass(u,"loved");S.setAttr(u,"title","取消收藏")}else{if(r!=0){S.removeClass(u,"loved");S.setAttr(u,"title","收藏")}}}};d.mod=new a();d.baidu_sio=g;window.packFmSongsList=[];window.packFmLoadSongs=function(k){var m=k.list;for(var l=0;l<m.length-1;l++){for(var h=l+1;h<m.length;h++){if(m[l].id==m[h].id){m.splice(h,1)}}}S.each(k.list,function(i){window.packFmSongsList.push({song_id:i.id,type:i.type})})};window.packFmLoadSongsMore=function(i){var j=i.data.songList;var h=0;S.each(j,function(k){if(k.songLink&&k.songLink!=""&&k.songLink.toLowerCase().indexOf("xcode=")<0){k.songLink=k.songLink+"?xcode="+i.data.xcode}S.extend(window.packFmSongsList[h++],{songLink:k.songLink,lrcLink:k.lrcLink,singer_id:k.artistId,song_id:k.songId,song_name:k.songName,singer_name:k.artistName,song_time:k.time,album_id:k.albumId,album_name:k.albumName,songPicBig:k.songPicBig,songXcodeTime:+(new Date())});if(!window.packFmSongsList[h-1].songLink){window.packFmSongsList[h-1].songLink="emptyLink"}})}});F.module("musicplus:mngr/fm_data",function(c,b,a){b.getData=function(l){musicTime=new Date();var j=$.ls;var f="_"+s_session.portrait+"_";var g,h,e=50;if(!j||!j){return}var m=j.get(f+"fm_cl");if(m.status==0&&m.value&&m.value!=""){g=m.value}else{g="public_tuijian_suibiantingting"}var d=j.get(f+"fm_cl_name");if(d.status==0&&d.value&&d.value!=""){h=d.value}else{h="随便听听"}var k=j.get(f+"fm_cl_dv");if(k.status==0&&k.value!=null&&k.value!=undefined&&k.value!=""){e=k.value}var i={};i={data:{content:{list:[],id:g,name:h,volume:e}}};l&&l(i)}});F.module("musicplus:mods/baidu_fm",function(d,c,b){var e=d("mods_extend/baidu_fm_player"),a=d("mods_extend/baidu_fm_channel_panel").html;var h=function(k){var l=$("#"+k),j=S.q("bd-fm-jump",l)[0],o=S.q("bd-fm-title",l)[0],n=S.q("bd-fm-channel",l)[0];$("#s_main").append("<div id='s_p_l_a_y_e_r' style='position:absolute;width:0px;height:0px;top:0px;left:-1px;'></div>");var m=function(p){if(baidu.packFmCurrentChannel&&baidu.packFmCurrentChannel!=""){S.setAttr(p,"href","http://fm.baidu.com/#/channel/"+baidu.packFmCurrentChannel)}};var i=function(){e.playerIns&&e.playerIns.goPause()};S.on(j,"mousedown",function(p){S.event.stop(p)});S.on(o,"mousedown",function(p){S.event.stop(p)});S.on(j,"click",function(p){i()});S.on(o,"click",function(p){i()});S.on(o,"mouseover",function(){m(S.q("jump-link",o)[0])});S.on(j,"mouseover",function(){m(S.q("jump-link",j)[0])});S.on(n,"mousedown",function(p){S.event.stop(p)});b.listen("musicplus:mods_extend/baidu_fm_mod_extend","fm_data_loaded",function(p){g(k)})};var g=function(j){e.playerIns.init();var k=S.g(j);var l=this;var m=function(o){};$(S.q("change-panel",k)[0]).append(a);var n=S.q("change-panel",k)[0],i=S.q("change-btn",k)[0];e.playerCtrl.init();e.volumeCtrl.init();e.changePnl.init(n,i,m);e.lrcShow.init(true);e.lrcScroll.init();e.playerCLog.init([{dom:S.q("bd-fm-jump",k)[0],arg:"jumpBtn"},{dom:S.q("bd-fm-title",k)[0],arg:"logo"},{dom:S.q("s-name",k)[0],arg:"songName"},{dom:S.q("s-author",k)[0],arg:"singerName"}]);b.listen(["musicplus:mods_extend/baidu_fm_player"],"user-has-no-lovesongs",function(){if($("#lovesongs_fail_tip")[0]){return}try{F.use("superplus:common/guide_tip",function(q){var p=q.render({id:"lovesongs_fail_tip",arrowPosLeft:302,arrowType:"down",width:340,pos:{left:433,top:22},content:"您还没有收藏过歌曲，去其他频道把喜欢的音乐标上红心吧",hasClose:false});$(k).append(p);setTimeout(function(){if($("#lovesongs_fail_tip")[0]){$("#lovesongs_fail_tip").remove()}},3000)})}catch(o){}})};var f=function(){if(e.playerIns){e.playerIns.goPause();e.playerIns.player.stop();clearTimeout(e.lrcShow.updateTimer)}if(S.g("s_p_l_a_y_e_r")){setTimeout(function(){S.dom.remove(S.g("s_p_l_a_y_e_r"))},200)}};c.onClosed=f;c.init=h});F.module("musicplus:fmplaycore/play_engine",function(require,exports,ctx){var T,baidu=T=baidu||{version:"1.5.2.2"};baidu.guid="$BAIDU$";baidu.$$=window[baidu.guid]=window[baidu.guid]||{global:{}};baidu.number=baidu.number||{};baidu.number.pad=function(source,length){var pre="",negative=(source<0),string=String(Math.abs(source));if(string.length<length){pre=(new Array(length-string.length+1)).join("0")}return(negative?"-":"")+pre+string};baidu.lang=baidu.lang||{};baidu.lang.isFunction=function(source){return"[object Function]"==Object.prototype.toString.call(source)};baidu.lang.guid=function(){return"TANGRAM$"+baidu.$$._counter++};baidu.$$._counter=baidu.$$._counter||1;baidu.lang.Class=function(){this.guid=baidu.lang.guid();!this.__decontrolled&&(baidu.$$._instances[this.guid]=this)};baidu.$$._instances=baidu.$$._instances||{};baidu.lang.Class.prototype.dispose=function(){delete baidu.$$._instances[this.guid];for(var property in this){typeof this[property]!="function"&&delete this[property]}this.disposed=true};baidu.lang.Class.prototype.toString=function(){return"[object "+(this.__type||this._className||"Object")+"]"};window.baiduInstance=function(guid){return baidu.$$._instances[guid]};baidu.lang.isString=function(source){return"[object String]"==Object.prototype.toString.call(source)};baidu.isString=baidu.lang.isString;baidu.lang.Event=function(type,target){this.type=type;this.returnValue=true;this.target=target||null;this.currentTarget=null};baidu.lang.Class.prototype.fire=baidu.lang.Class.prototype.dispatchEvent=function(event,options){baidu.lang.isString(event)&&(event=new baidu.lang.Event(event));!this.__listeners&&(this.__listeners={});options=options||{};for(var i in options){event[i]=options[i]}var i,n,me=this,t=me.__listeners,p=event.type;event.target=event.target||(event.currentTarget=me);p.indexOf("on")&&(p="on"+p);typeof me[p]=="function"&&me[p].apply(me,arguments);if(typeof t[p]=="object"){for(i=0,n=t[p].length;i<n;i++){t[p][i]&&t[p][i].apply(me,arguments)}}return event.returnValue};baidu.lang.Class.prototype.on=baidu.lang.Class.prototype.addEventListener=function(type,handler,key){if(typeof handler!="function"){return}!this.__listeners&&(this.__listeners={});var i,t=this.__listeners;type.indexOf("on")&&(type="on"+type);typeof t[type]!="object"&&(t[type]=[]);for(i=t[type].length-1;i>=0;i--){if(t[type][i]===handler){return handler}}t[type].push(handler);key&&typeof key=="string"&&(t[type][key]=handler);return handler};baidu.lang.createClass=function(constructor,options){options=options||{};var superClass=options.superClass||baidu.lang.Class;var fn=function(){var me=this;options.decontrolled&&(me.__decontrolled=true);superClass.apply(me,arguments);for(i in fn.options){me[i]=fn.options[i]}constructor.apply(me,arguments);for(var i=0,reg=fn["\x06r"];reg&&i<reg.length;i++){reg[i].apply(me,arguments)}};fn.options=options.options||{};var C=function(){},cp=constructor.prototype;C.prototype=superClass.prototype;var fp=fn.prototype=new C();for(var i in cp){fp[i]=cp[i]}var type=options.className||options.type;typeof type=="string"&&(fp.__type=type);fp.constructor=cp.constructor;fn.extend=function(json){for(var i in json){fn.prototype[i]=json[i]}return fn};return fn};baidu.array=baidu.array||{};baidu.array.some=function(source,iterator,thisObject){var i=0,len=source.length;for(;i<len;i++){if(i in source&&iterator.call(thisObject||source,source[i],i)){return true}}return false};baidu.fn=baidu.fn||{};baidu.fn.bind=function(func,scope){var xargs=arguments.length>2?[].slice.call(arguments,2):null;return function(){var fn=baidu.lang.isString(func)?scope[func]:func,args=(xargs)?xargs.concat([].slice.call(arguments,0)):arguments;return fn.apply(scope||fn,args)}};baidu.dom=baidu.dom||{};baidu.dom.g=function(id){if(!id){return null}if("string"==typeof id||id instanceof String){return document.getElementById(id)}else{if(id.nodeName&&(id.nodeType==1||id.nodeType==9)){return id}}return null};baidu.g=baidu.G=baidu.dom.g;baidu.browser=baidu.browser||{};baidu.browser.ie=baidu.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?(document.documentMode||+RegExp["\x241"]):undefined;baidu.dom._NAME_ATTRS=(function(){var result={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};if(baidu.browser.ie<8){result["for"]="htmlFor";result["class"]="className"}else{result.htmlFor="for";result.className="class"}return result})();baidu.dom.setAttr=function(element,key,value){element=baidu.dom.g(element);if("style"==key){element.style.cssText=value}else{key=baidu.dom._NAME_ATTRS[key]||key;element.setAttribute(key,value)}return element};baidu.setAttr=baidu.dom.setAttr;baidu.dom.setAttrs=function(element,attributes){element=baidu.dom.g(element);for(var key in attributes){baidu.dom.setAttr(element,key,attributes[key])}return element};baidu.setAttrs=baidu.dom.setAttrs;baidu.dom.create=function(tagName,opt_attributes){var el=document.createElement(tagName),attributes=opt_attributes||{};return baidu.dom.setAttrs(el,attributes)};baidu.dom._styleFixer=baidu.dom._styleFixer||{};baidu.dom._styleFilter=baidu.dom._styleFilter||[];baidu.dom._styleFilter.filter=function(key,value,method){for(var i=0,filters=baidu.dom._styleFilter,filter;filter=filters[i];i++){if(filter=filter[method]){value=filter(key,value)}}return value};baidu.string=baidu.string||{};baidu.string.toCamelCase=function(source){if(source.indexOf("-")<0&&source.indexOf("_")<0){return source}return source.replace(/[-_][^-_]/g,function(match){return match.charAt(1).toUpperCase()})};baidu.dom.setStyle=function(element,key,value){var dom=baidu.dom,fixer;element=dom.g(element);key=baidu.string.toCamelCase(key);if(fixer=dom._styleFilter){value=fixer.filter(key,value,"set")}fixer=dom._styleFixer[key];(fixer&&fixer.set)?fixer.set(element,value,key):(element.style[fixer||key]=value);return element};baidu.setStyle=baidu.dom.setStyle;baidu.dom.setStyles=function(element,styles){element=baidu.dom.g(element);for(var key in styles){baidu.dom.setStyle(element,key,styles[key])}return element};baidu.setStyles=baidu.dom.setStyles;baidu.each=baidu.array.forEach=baidu.array.each=function(source,iterator,thisObject){var returnValue,item,i,len=source.length;if("function"==typeof iterator){for(i=0;i<len;i++){item=source[i];returnValue=iterator.call(thisObject||source,item,i);if(returnValue===false){break}}}return source};baidu.object=baidu.object||{};baidu.object.each=function(source,iterator){var returnValue,key,item;if("function"==typeof iterator){for(key in source){if(source.hasOwnProperty(key)){item=source[key];returnValue=iterator.call(source,item,key);if(returnValue===false){break}}}}return source};baidu.platform=baidu.platform||{};baidu.platform.isAndroid=/android/i.test(navigator.userAgent);baidu.platform.isIpad=/ipad/i.test(navigator.userAgent);baidu.platform.isIphone=/iphone/i.test(navigator.userAgent);baidu.platform.isMacintosh=/macintosh/i.test(navigator.userAgent);baidu.platform.isWindows=/windows/i.test(navigator.userAgent);baidu.platform.isX11=/x11/i.test(navigator.userAgent);baidu.lang.isNumber=function(source){return"[object Number]"==Object.prototype.toString.call(source)&&isFinite(source)};try{if(/(\d+\.\d+)/.test(external.max_version)){baidu.browser.maxthon=+RegExp["\x241"]}}catch(e){}baidu.swf=baidu.swf||{};baidu.array.remove=function(source,match){var len=source.length;while(len--){if(len in source&&source[len]===match){source.splice(len,1)}}return source};baidu.lang.isArray=function(source){return"[object Array]"==Object.prototype.toString.call(source)};baidu.lang.toArray=function(source){if(source===null||source===undefined){return[]}if(baidu.lang.isArray(source)){return source}if(typeof source.length!=="number"||typeof source==="string"||baidu.lang.isFunction(source)){return[source]}if(source.item){var l=source.length,array=new Array(l);while(l--){array[l]=source[l]}return array}return[].slice.call(source)};baidu.swf.getMovie=function(name){var movie=document[name],ret;return baidu.browser.ie==9?movie&&movie.length?(ret=baidu.array.remove(baidu.lang.toArray(movie),function(item){return item.tagName.toLowerCase()!="embed"})).length==1?ret[0]:ret:movie:movie||window[name]};baidu.swf.Proxy=function(id,property,loadedHandler){var me=this,flash=this._flash=baidu.swf.getMovie(id),timer;if(!property){return this}timer=setInterval(function(){try{if(flash[property]){me._initialized=true;clearInterval(timer);if(loadedHandler){loadedHandler()}}}catch(e){}},100)};baidu.swf.Proxy.prototype.getFlash=function(){return this._flash};baidu.swf.Proxy.prototype.isReady=function(){return !!this._initialized};baidu.swf.Proxy.prototype.call=function(methodName,var_args){try{var flash=this.getFlash(),args=Array.prototype.slice.call(arguments);args.shift();if(flash[methodName]){flash[methodName].apply(flash,args)}}catch(e){}};baidu.browser.opera=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(navigator.userAgent)?+(RegExp["\x246"]||RegExp["\x242"]):undefined;baidu.dom.insertHTML=function(element,position,html){element=baidu.dom.g(element);var range,begin;if(element.insertAdjacentHTML&&!baidu.browser.opera){element.insertAdjacentHTML(position,html)}else{range=element.ownerDocument.createRange();position=position.toUpperCase();if(position=="AFTERBEGIN"||position=="BEFOREEND"){range.selectNodeContents(element);range.collapse(position=="AFTERBEGIN")}else{begin=position=="BEFOREBEGIN";range[begin?"setStartBefore":"setEndAfter"](element);range.collapse(begin)}range.insertNode(range.createContextualFragment(html))}return element};baidu.insertHTML=baidu.dom.insertHTML;baidu.swf.version=(function(){var n=navigator;if(n.plugins&&n.mimeTypes.length){var plugin=n.plugins["Shockwave Flash"];if(plugin&&plugin.description){return plugin.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s)+r/,".")+".0"}}else{if(window.ActiveXObject&&!window.opera){for(var i=12;i>=2;i--){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+i);if(c){var version=c.GetVariable("$version");return version.replace(/WIN/g,"").replace(/,/g,".")}}catch(e){}}}}})();baidu.string.encodeHTML=function(source){return String(source).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};baidu.encodeHTML=baidu.string.encodeHTML;baidu.swf.createHTML=function(options){options=options||{};var version=baidu.swf.version,needVersion=options.ver||"6.0.0",vUnit1,vUnit2,i,k,len,item,tmpOpt={},encodeHTML=baidu.string.encodeHTML;for(k in options){tmpOpt[k]=options[k]}options=tmpOpt;if(version){version=version.split(".");needVersion=needVersion.split(".");for(i=0;i<3;i++){vUnit1=parseInt(version[i],10);vUnit2=parseInt(needVersion[i],10);if(vUnit2<vUnit1){break}else{if(vUnit2>vUnit1){return""}}}}else{return""}var vars=options.vars,objProperties=["classid","codebase","id","width","height","align"];options.align=options.align||"middle";options.classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000";options.codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0";options.movie=options.url||"";delete options.vars;delete options.url;if("string"==typeof vars){options.flashvars=vars}else{var fvars=[];for(k in vars){item=vars[k];fvars.push(k+"="+encodeURIComponent(item))}options.flashvars=fvars.join("&")}var str=["<object "];for(i=0,len=objProperties.length;i<len;i++){item=objProperties[i];str.push(" ",item,'="',encodeHTML(options[item]),'"')}str.push(">");var params={wmode:1,scale:1,quality:1,play:1,loop:1,menu:1,salign:1,bgcolor:1,base:1,allowscriptaccess:1,allownetworking:1,allowfullscreen:1,seamlesstabbing:1,devicefont:1,swliveconnect:1,flashvars:1,movie:1};for(k in options){item=options[k];k=k.toLowerCase();if(params[k]&&(item||item===false||item===0)){str.push('<param name="'+k+'" value="'+encodeHTML(item)+'" />')}}options.src=options.movie;options.name=options.id;delete options.id;delete options.movie;delete options.classid;delete options.codebase;options.type="application/x-shockwave-flash";options.pluginspage="http://www.macromedia.com/go/getflashplayer";str.push("<embed");var salign;for(k in options){item=options[k];if(item||item===false||item===0){if((new RegExp("^salign\x24","i")).test(k)){salign=item;continue}str.push(" ",k,'="',encodeHTML(item),'"')}}if(salign){str.push(' salign="',encodeHTML(salign),'"')}str.push("></embed></object>");return str.join("")};baidu.swf.create=function(options,target){options=options||{};var html=baidu.swf.createHTML(options)||options.errorMessage||"";if(target&&"string"==typeof target){target=document.getElementById(target)}baidu.dom.insertHTML(target||document.body,"beforeEnd",html)};T.undope=true;var T=S.extend(T,S);var mbox=mbox||{};mbox.namespace=function(){var a=arguments,o=null,i,j,d;for(i=0,len=a.length;i<len;i++){d=(""+a[i]).split(".");o=mbox;for(j=(d[0]=="mbox")?1:0;j<d.length;j=j+1){o[d[j]]=o[d[j]]||{};o=o[d[j]]}}return o};T.extend(mbox,{Fuze:function(){var queue,fn,infire;queue=[];fn=function(process){if(infire){process()}else{queue.push(process)}};fn.fire=function(){while(queue.length){queue.shift()()}infire=true};fn.extinguish=function(){infire=false};fn.wettish=function(){this.fire();this.extinguish()};return fn},convertTime:function(time){var minute,second;time=Math.round(time/1000);minute=Math.floor(time/60);second=time%60;return T.number.pad(minute,2)+":"+T.number.pad(second,2)},Timer:(function(window,undefined){var fn=function(delay,repeatCount){this._timer=function(){};this._listener=function(){};this._timerComplete=function(){};this._timerID=null;this._delay=this._remain=delay;this._repeatCount=repeatCount||0;this._currentCount=0;this._isRunning=false;this._startTime=this._endTime=0;this.EVENTS={TIMER:"timer",COMPLETE:"timerComplete"}};fn.prototype={_createTimer:function(delay,repeatCount){var me=this;if(repeatCount==1){return function(){return window.setTimeout(function(){me.reset();me._listener(me._delay,repeatCount);me._timerComplete()},delay)}}else{return function(){return window.setInterval(function(){if(repeatCount!=0&&me._currentCount>=repeatCount){me.reset();me._timerComplete()}else{me._currentCount++;me._listener(delay,me._currentCount)}},delay)}}},addEventListener:function(type,listener){if(type=="timer"){this._listener=listener;this._timer=this._createTimer(this._delay,this._repeatCount)}else{if(type=="timerComplete"){this._timerComplete=listener}}},reset:function(){this.stop();if(this._repeatCount==1){this._timer=this._createTimer(this._delay,this._repeatCount)}this._currentCount=0;this._remain=this._delay;this._startTime=this._endTime=0},start:function(){if(!this._timerID){this._timerID=this._timer();if(this._repeatCount==1){this._startTime=new Date().getTime()}this._isRunning=true}},stop:function(){if(this._timerID){if(this._repeatCount==1){window.clearTimeout(this._timerID)}else{window.clearInterval(this._timerID)}this._timerID=null;this._isRunning=false}},pause:function(){if(this._repeatCount==1){if(this._timerID){this.stop();this._endTime=new Date().getTime();this._remain=this._remain-(this._endTime-this._startTime);if(this._remain>0){this._timer=this._createTimer(this._remain,1)}else{this.reset()}}}else{this.stop()}},getCurrentCount:function(){return this._currentCount},isRunning:function(){return this._isRunning}};return fn})(window),StopWatch:(function(window,undefined){var count=0;var fn=function(){this.startTime=0;this.isRunning=false;this.isReset=true;this.passedTime=0;count++};fn.prototype={reset:function(){this.startTime=0;this.pauseTime=0;this.passedTime=0;this.isRunning=false;this.isReset=true},start:function(){if(this.isReset){this.reset();this.startTime=new Date().getTime()}else{if(!this.isRunning){this.startTime=new Date().getTime()}}this.isRunning=true;this.isReset=false},pause:function(){if(!this.isReset&&this.isRunning){this.pauseTime=new Date().getTime();this.passedTime+=this.pauseTime-this.startTime;this.isRunning=false}},isRunning:function(){return this.isRunning},isReset:function(){return this.isReset},getTime:function(){if(this.isReset){return 0}else{if(this.isRunning){return new Date().getTime()-this.startTime+this.passedTime}else{return this.passedTime}}},getCounts:function(){return count}};return fn})(window)});mbox.namespace("mbox.lang");T.extend(mbox.lang,{createClass:function(constructor,options){var fn=T.lang.createClass(constructor,options);fn.extend=function(json){for(var i in json){fn.prototype[i]=(function(method,name){if(T.lang.isFunction(method)){return function(){this.dispatchEvent(name,{name:name,arguments:arguments});var res=method.apply(this,arguments);return res}}else{return method}})(json[i],i)}return fn};return fn}});var PlayEngine_Interface=mbox.lang.createClass((function(window,undefined){var guid=0;var defConf={mute:false,volume:50};var fn=function(conf){this.STATES={INIT:"init",READY:"ready",STOP:"stop",PLAY:"play",PAUSE:"pause",END:"end",BUFFERING:"buffering",PREBUFFER:"pre-buffer",ERROR:"error"};this.EVENTS={STATECHANGE:"player_playStateChange",POSITIONCHANGE:"player_positionChange",PROGRESS:"player_progress",ERROR:"player_error",INIT:"player_initSuccess",INITFAIL:"player_initFail"};conf=conf||{};this.mute=typeof conf.mute=="undefined"?defConf.mute:!!conf.mute;this.volume=typeof conf.volume=="undefined"?defConf.volume:conf.volume;this.ready=false;this.url="";this.state=this.STATES.INIT;this.engineType="";this.stateStack=[this.STATES.INIT];this.supportMimeType=[]};fn.prototype={newId:function(){return"_m3_"+guid++},init:function(){},reset:function(){},setUrl:function(url){},getUrl:function(){return this.url},play:function(){},pause:function(){},stop:function(){},setMute:function(mute){},getMute:function(){return this.mute},setVolume:function(vol){},getVolume:function(){return this.volume},getState:function(){return""},setCurrentPosition:function(pos){},getCurrentPosition:function(){return 0},getLoadedPercent:function(){return 0},getLoadedBytes:function(){return 0},getTotalBytes:function(){return 0},getTotalTime:function(){return 0},getVersion:function(){return""},getEngineType:function(){return this.engineType},canPlayType:function(mimeType){var list=this.getSupportMimeTypeList();return T.array.some(list,function(item,index){return mimeType==item})},getSupportMimeTypeList:function(){return this.supportMimeType},setEventListener:function(eventName,listener){var _listener=T.fn.bind(function(){return listener.apply(this,arguments)},this);this.addEventListener(eventName,_listener)}};return fn})(window),{superClass:T.lang.Class,className:"PlayEngine_Interface"});var PlayEngine=mbox.lang.createClass(function(conf){conf=conf||{};this.subEnginesConf=[];this.subEnginesInitArgs={};this.curEngine=null;this.curEngineType="";this.unInitEngineList=[];this.engineList=[];this.engineTypeList=[];this.ready=false;this.defaultExt=".mp3";this.coreContainer=null;this.EVENTS={STATECHANGE:"player_playStateChange",POSITIONCHANGE:"player_positionChange",PROGRESS:"player_progress",ERROR:"player_error",INIT:"player_initSuccess",INITFAIL:"player_initFail"};this.STATES={INIT:"init",READY:"ready",STOP:"stop",PLAY:"play",PAUSE:"pause",END:"end",BUFFERING:"buffering",PREBUFFER:"pre-buffer",ERROR:"error"};this.progressTimer=new mbox.Timer(200,0);this.positionTimer=new mbox.Timer(100,0);this._initEngines(conf)},{className:"PlayEngine"}).extend({_error:function(errMsg){throw new Error(errMsg)},_initEngines:function(config){this.coreContainer=config.el||null;this.subEnginesConf=config.subEngines||[];T.array.each(this.subEnginesConf,T.fn.bind(function(item,index){var subEngineName=item.constructorName,args=item.args||{},subEngineConstructor;this.subEnginesInitArgs[subEngineName]=args;try{subEngineConstructor=eval(subEngineName);if(!T.lang.isFunction(subEngineConstructor)){return}}catch(e){return}var engine=new subEngineConstructor(args);this.unInitEngineList.push(engine)},this));this.curEngine=this.unInitEngineList[0]},init:function(options){if(this.ready){return this._error("")}options=options||{};this.subEnginesInitArgs=options.subEngines?options.subEngines:this.subEnginesInitArgs;this.coreContainer=options.el?options.el:this.coreContainer;if(!this.coreContainer){var con=T.dom.create("div",{id:"_player_container_"+T.lang.guid()});T.dom.setStyles(con,{width:"1px",height:"1px",overflow:"hidden"});document.body.appendChild(con);this.coreContainer=options.el=con}T.array.each(this.unInitEngineList,T.fn.bind(function(engine,index){var subEngineNameToString=engine.toString(),subEngineName="",reg=/^\[object (.*)\]$/i;if(reg.test(subEngineNameToString)){subEngineName=RegExp.$1}var args=this.subEnginesInitArgs[subEngineName]||{};if(engine.test(true)){args.instanceName=args.instanceName+".engineList["+this.engineList.length+"]";args.el=args.el||this.coreContainer;this.engineList.push(engine);engine.init.apply(engine,[args])}},this));this.switchEngineByUrl(this.defaultExt);this.ready=true;this._initProgressEvent();this._initPositionChangeEvent()},canPlayType:function(mimeType){return T.array.some(this.engineList,function(item,index){return item.canPlayType(mimeType)})},getSupportMimeTypeList:function(){var list=[];T.array.each(this.engineList,T.fn.bind(function(item,index){list=list.concat(item.getSupportMimeTypeList())},this));return list},switchEngineByUrl:function(url){var has=T.array.some(this.engineList,T.fn.bind(function(item,index){var str=item.getSupportMimeTypeList().join("|");var reg=new RegExp("\\.("+str+")(\\?|$)","ig");if(reg.test(url)){this.curEngine=item;this.curEngineType=item.getEngineType();return true}},this));var stopRecursion=arguments[1];if(!has&&!stopRecursion){arguments.callee.apply(this,[this.defaultExt,true])}},switchEngineByMimeType:function(mimeType){T.array.some(this.engineList,T.fn.bind(function(item,index){if(item.canPlayType(mimeType)){this.curEngine=item;this.curEngineType=item.getEngineType();return true}},this))},reset:function(){this.curEngine.reset.apply(this.curEngine,arguments)},setUrl:function(url){var oldEngie=this.curEngine;this.switchEngineByUrl(url);if(oldEngie&&oldEngie!=this.curEngine){oldEngie.stop()}if(this.curEngine){this.curEngine.setUrl.apply(this.curEngine,arguments)}},getUrl:function(){return this.curEngine.getUrl.apply(this.curEngine,arguments)},play:function(pos){if(typeof pos=="undefined"){if(this.curEngine){return this.curEngine.play.apply(this.curEngine,arguments)}}else{return this.setCurrentPosition(pos)}},pause:function(){if(this.curEngine){return this.curEngine.pause.apply(this.curEngine,arguments)}},stop:function(){if(this.curEngine){return this.curEngine.stop.apply(this.curEngine,arguments)}},setMute:function(mute){var args=arguments;T.array.each(this.engineList,function(item,index){item.setMute.apply(item,args)})},getMute:function(){if(this.curEngine){return this.curEngine.getMute.apply(this.curEngine,arguments)}return false},setVolume:function(volume){var args=arguments;T.array.each(this.engineList,function(item,index){item.setVolume.apply(item,args)})},getVolume:function(){if(this.curEngine){return this.curEngine.getVolume.apply(this.curEngine,arguments)}return 0},setCurrentPosition:function(time){if(this.curEngine){return this.curEngine.setCurrentPosition.apply(this.curEngine,arguments)}},getCurrentPosition:function(){if(this.curEngine){return this.curEngine.getCurrentPosition.apply(this.curEngine,arguments)}return 0},getCurrentPositionString:function(){return mbox.convertTime(this.getCurrentPosition())},getLoadedPercent:function(){if(this.curEngine){return this.curEngine.getLoadedPercent.apply(this.curEngine,arguments)}return 0},getLoadedBytes:function(){if(this.curEngine){return this.curEngine.getLoadedBytes.apply(this.curEngine,arguments)}},getTotalBytes:function(){if(this.curEngine){return this.curEngine.getTotalBytes.apply(this.curEngine,arguments)}return 0},getTotalTime:function(){if(this.curEngine){return this.curEngine.getTotalTime.apply(this.curEngine,arguments)}return 0},getTotalTimeString:function(){return mbox.convertTime(this.getTotalTime())},getCurEngine:function(){return this.curEngine},getEngineType:function(){return this.getCurEngine().getEngineType()},getVersion:function(){var res={};T.array.each(this.engineList,function(item,index){res[item.getEngineType()]=item.getVersion()});return res},getState:function(){if(this.curEngine){return this.curEngine.getState.apply(this.curEngine,arguments)}return null},setEventListener:function(eventName,listener){var _listener;if(eventName==this.EVENTS.INITFAIL||eventName==this.EVENTS.INIT){_listener=T.fn.bind(function(e){listener.apply(this,arguments)},this)}else{_listener=T.fn.bind(function(e){if(e.target&&e.target.getEngineType()==this.curEngineType){listener.apply(this,arguments)}},this)}T.array.each(this.unInitEngineList,function(item,index){item.setEventListener(eventName,_listener)})},_initProgressEvent:function(){this.progressTimer.addEventListener("timer",T.fn.bind(function(delay,repeatCount){var percent=this.getLoadedPercent();this.curEngine.dispatchEvent(this.EVENTS.PROGRESS,{progress:percent,totalBytes:this.getTotalBytes(),loadedBytes:this.getLoadedBytes(),totalTime:this.getTotalTime()});if(percent==1){this.progressTimer.stop()}},this));this.setEventListener(this.EVENTS.STATECHANGE,T.fn.bind(function(e){var st=e.newState;switch(st){case this.STATES.PREBUFFER:case this.STATES.PLAY:if(this.getLoadedPercent()<1){this.progressTimer.start()}break;case this.STATES.STOP:case this.STATES.READY:case this.STATES.END:this.progressTimer.reset();break}},this));this.setEventListener("setUrl",T.fn.bind(function(e){this.progressTimer.reset();this.progressTimer.start()},this))},_initPositionChangeEvent:function(){this.positionTimer.addEventListener("timer",T.fn.bind(function(delay,repeatCount){var curPos=this.getCurrentPosition();this.curEngine.dispatchEvent(this.EVENTS.POSITIONCHANGE,{position:curPos})},this));this.setEventListener(this.EVENTS.STATECHANGE,T.fn.bind(function(e){var st=e.newState;switch(st){case this.STATES.PLAY:this.positionTimer.start();break;case this.STATES.STOP:case this.STATES.PAUSE:this.positionTimer.pause();this.curEngine.dispatchEvent(this.EVENTS.POSITIONCHANGE,{position:this.getCurrentPosition()});break;case this.STATES.READY:case this.STATES.END:this.positionTimer.reset();break}},this));this.setEventListener("setUrl",T.fn.bind(function(e){this.positionTimer.reset()},this))}});var PlayEngine_Audio=mbox.lang.createClass(function(conf){conf=conf||{};this.engineType="audio";this.contentType={mp3:["audio/mpeg","audio/mp3"],mp4:["audio/mp4","audio/MP4A-LATM","video/mpeg4","audio/mpeg4-generic"],m4a:["audio/mp4","audio/MP4A-LATM","video/mpeg4","audio/mpeg4-generic"],aac:["audio/aac","audio/aacp"],"3gp":["audio/3gpp","audio/3gpp2"],ogg:["audio/ogg","video/ogg","application/ogg","audio/vorbis"],oga:["audio/ogg","application/ogg","audio/vorbis"],wma:["audio/x-ms-wma"]};this.supportAudio=typeof Audio!="undefined";this.supportMimeType=[];if(this.supportAudio){this.audio=new Audio();if(typeof this.audio.canPlayType=="function"){T.object.each(this.contentType,T.fn.bind(function(types,ext){for(var i=0;i<types.length;i++){var canPlayType=this.audio.canPlayType(types[i]);if(canPlayType=="probably"||canPlayType=="maybe"){this.supportMimeType.push(ext);break}}},this))}if(!this.supportMimeType.length){this.supportAudio=false}}this.supportVolume=T.fn.bind(function(){if(this.supportAudio){this.audio.volume=0.5;return(this.audio.volume<1)}return false},this)()},{superClass:PlayEngine_Interface,className:"PlayEngine_Audio"}).extend({test:function(dispatch){dispatch=!!dispatch;if(!this.supportAudio&&dispatch){this.dispatchEvent(this.EVENTS.INITFAIL,{engineType:this.engineType})}return this.supportAudio},init:function(options){this.lastState=this.STATES.INIT;this.muted=this.audio.muted=false;this.volume=50;this.audio.volume=0.5;this.url="";this._definedEvents();this.state=this.STATES.READY;this.dispatchEvent(this.EVENTS.INIT,{engineType:this.engineType,engine:this.audio})},reset:function(){if(!this.supportAudio){return}this.url="";this.audio.pause();this.state="ready";this.lastState="ready"},setUrl:function(url){if(!this.supportAudio){return}this.url=url;this.audio.src=url;this.audio.load();this._firePlayStateChange(this.STATES.PREBUFFER)},play:function(){if(!this.supportAudio){return}if(this.state!="ready"){if(T.platform.isAndroid&&T.browser.isWebkit&&this.audio.readyState<3){var canPlay=T.fn.bind(function(){this.audio.play();this.audio.removeEventListener("canplay",canPlay,false)},this);this.audio.addEventListener("canplay",canPlay,false)}else{this.audio.play()}}},pause:function(){if(!this.supportAudio){return}if(this.state!=this.STATES.STOP&&this.state!=this.STATES.READY&&this.state!=this.STATES.END){this.audio.pause();this._firePlayStateChange(this.STATES.PAUSE)}},stop:function(){if(!this.supportAudio){return}if(this.state!=this.STATES.READY){if(this.audio.currentTime!=0){this.audio.currentTime=0}this.audio.pause();this._firePlayStateChange(this.STATES.STOP)}},setMute:function(mute){if(!this.supportAudio){return}this.audio.muted=this.mute=mute},setVolume:function(volume){if(!this.supportAudio){return}volume=T.lang.isNumber(volume)?volume:50;volume=Math.max(Math.min(volume,100),0);this.volume=volume;this.audio.volume=volume/100},setCurrentPosition:function(time){if(!this.supportAudio){return}if(T.platform.isAndroid&&this.audio.readyState<3){var canPlay=T.fn.bind(function(){this.audio.currentTime=time/1000;this.audio.play();this.audio.removeEventListener("canplay",canPlay,false)},this);this.audio.addEventListener("canplay",canPlay,false)}else{this.audio.currentTime=time/1000;this.audio.play()}},getCurrentPosition:function(){if(!this.supportAudio){return 0}return Math.round(this.audio.currentTime*1000)},getLoadedPercent:function(){try{var end=this.audio.buffered.end(0),dur=this.audio.duration;dur=isNaN(dur)?0:dur;return Math.round(end/dur*100)/100}catch(e){return 0}},getTotalTime:function(){if(!this.supportAudio){return 0}var dur=this.audio.duration;dur=isNaN(dur)?0:dur;return Math.round(dur*1000)},getState:function(){return this.state},_firePlayStateChange:function(stateName){if(this.state!=stateName){this.lastState=this.state;this.state=stateName;this.dispatchEvent(this.EVENTS.STATECHANGE,{newState:stateName,oldState:this.lastState,engineType:this.engineType})}},_definedEvents:function(){this.audio.addEventListener("error",T.fn.bind(function(){this._firePlayStateChange(this.STATES.ERROR);this.dispatchEvent(this.EVENTS.ERROR,{engineType:this.engineType})},this),false);this.audio.addEventListener("ended",T.fn.bind(function(){this._firePlayStateChange(this.STATES.END)},this),false);this.audio.addEventListener("playing",T.fn.bind(function(){this._firePlayStateChange(this.STATES.PLAY)},this),false);this.audio.addEventListener("pause",T.fn.bind(function(){if(this.getState()==this.STATES.PLAY){this._firePlayStateChange(this.getCurrentPosition()?this.STATES.PAUSE:this.STATES.STOP)}},this),false);this.audio.addEventListener("waiting",T.fn.bind(function(){this._firePlayStateChange(this.getCurrentPosition()?this.STATES.BUFFERING:this.STATES.PREBUFFER)},this),false)}});var PlayEngine_FMP_MP3=mbox.lang.createClass(function(conf){conf=conf||{};this.supportMimeType=["mp3"];this.engineType="fmp_mp3";this.swfPath="fmp_mp3.swf";this.flashVersionRequire=conf.flashVersionRequire||"9.0.0";this.versionErrorMessage=conf.versionErrorMessage||"";this.stateCode={"-2":this.STATES.INIT,"-1":this.STATES.READY,"0":this.STATES.STOP,"1":this.STATES.PLAY,"2":this.STATES.PAUSE,"3":this.STATES.END,"4":this.STATES.BUFFERING,"5":this.STATES.PREBUFFER,"6":this.STATES.ERROR};this.flashLoaded=false;this.flashReady=new mbox.Fuze()},{superClass:PlayEngine_Interface,className:"PlayEngine_FMP_MP3"}).extend({test:function(dispatch){return this._checkPlayer(dispatch)},init:function(options){options=options||{};var el=options.el;this.instanceName=options.instanceName;this.swfPath=options.swfPath||this.swfPath;var inner,id=this.newId();if(T.lang.isString(el)){el=T.g(el)}if(!el){el=T.dom.create("div");document.body.appendChild(el)}inner=T.dom.create("div");el.appendChild(inner);if(T.browser.maxthon||T.browser.ie){this.swfPath+="?"+id+"_"+Math.random()}T.swf.create({id:this.flashObjectId=id,width:"1px",height:"1px",ver:this.flashVersionRequire,errorMessage:this.versionErrorMessage,allowscriptaccess:"always",url:this.swfPath,bgcolor:"#ffffff",wmode:"window",scale:"noscale",vars:{_instanceName:this.instanceName+"",_buffertime:2000}},inner);this.flashObject=T.swf.getMovie(this.flashObjectId)},reset:function(){this.stop();if(this.state!=this.STATES.INIT){this.url="";this.state=this.STATES.READY;this.stateStack=[this.STATES.READY]}},setUrl:function(url){this.flashReady(T.fn.bind(function(){this.url=url;this.flashObject.f_load(url)},this))},play:function(){this.flashReady(T.fn.bind(function(){if(this.state==this.STATES.PLAY){return}this.flashObject.f_play()},this))},pause:function(){this.flashReady(T.fn.bind(function(){if(this.state==this.STATES.PAUSE||this.state==this.STATES.STOP||this.state==this.STATES.END){return}this.flashObject.f_pause()},this))},stop:function(){this.flashReady(T.fn.bind(function(){if(this.state==this.STATES.STOP){return}this.flashObject.f_stop()},this))},setMute:function(mute){this.flashReady(T.fn.bind(function(){this.mute=mute;this.flashObject.setData("mute",mute)},this))},setVolume:function(volume){this.flashReady(T.fn.bind(function(){this.volume=volume;this.flashObject.setData("volume",volume)},this))},setCurrentPosition:function(time){this.flashReady(T.fn.bind(function(){this.flashObject.f_play(time)},this))},getCurrentPosition:function(){try{return this.flashLoaded?this.flashObject.getData("currentPosition"):0}catch(e){return 0}},getLoadedPercent:function(){return this.flashLoaded?this.flashObject.getData("loadedPct"):0},getTotalTime:function(){return this.flashLoaded?this.flashObject.getData("length"):0},getState:function(state){return T.lang.isNumber(state)?this.stateCode[state]:this.state},getVersion:function(){return T.swf.version},_firePlayStateChange:function(stateName){if(this.state!=stateName){this.state=stateName;this.stateStack.push(stateName);var previouState=this.stateStack.shift();this.dispatchEvent(this.EVENTS.STATECHANGE,{newState:stateName,oldState:previouState,engineType:this.engineType})}},_onLoad:function(){this.state=this.STATES.READY;this.stateStack=[this.state];this.dispatchEvent(this.EVENTS.INIT,{engineType:this.engineType,engine:this.flashObject});setTimeout(T.fn.bind(function(){this.flashReady.fire();this.flashLoaded=true},this),0)},_onPlayStateChange:function(state){this._firePlayStateChange(this.getState(state))},_checkPlayer:function(dispatch){dispatch=!!dispatch;var curVer=T.swf.version,reqVer=this.flashVersionRequire;if(curVer){var curVerArr=curVer.split("."),reqVerArr=reqVer.split(".");if(curVerArr[0]-reqVerArr[0]>=0&&curVerArr[1]-reqVerArr[1]>=0){return true}else{if(dispatch){this.dispatchEvent(this.EVENTS.INITFAIL,{engineType:this.engineType})}return false}}else{if(dispatch){this.dispatchEvent(this.EVENTS.INITFAIL,{engineType:this.engineType})}return false}}});window.baidu=window.baidu||{};window.baidu.packfpe=PlayEngine});F.module("musicplus:mods_extend/baidu_fm_music_log",function(a,c,h){var e="http://nsclick.baidu.com/v.gif?pid=304&ref=radio&source=pcwidget-newindex&username="+s_session.username;var j=[["song_id","song_title","singer_id","singer_name","album_id","album_name","channel"],["page","expoitem"],["position","link","channelduration","bufferCount","startTimestamp","connectTimestamp","fromstart","start2play","durationRaw","duration","auto"]];var f={playsong100ms:j[0],playstart:j[0],exposure:j[1],"60play":j[0],playend:j[0].concat(j[2]),click_singleFavor:j[0],click_cancelFavor:j[0],click_singleDel:j[0],click_passsong:j[0],click_pause:j[0],click_channel:j[0]};var i=function(l){var k=e+"&"+l;b(k)};var b=function(k){var m="imglog__"+(new Date()).getTime(),l=window[m]=new Image();l.onload=(l.onerror=function(){window[m]=null});l.src=k;l=null};var d=function(k){var m=f[k];var l={};h.use("mods_extend/baidu_fm_player",function(n){S.each(m,function(o){l[o]=n.getLoginfo(o)});l.type=k;i($.url.jsonToQuery(l))})};var g=function(){h.listen("mods_extend/baidu_fm_player","music-log-fire",function(k){d(k.arg)})}()});F.addLog("musicplus:mods_extend",{musicUserOpt:"0300000005",musicClick:"0300000001"});F.module("musicplus:mods_extend/baidu_fm_player",function(g,h,q){g("fmplaycore/play_engine");g("mods_extend/baidu_fm_music_log");var n=g("mods_extend/baidu_fm_mod_extend").mod;baidu=baidu||{};baidu.packPlayer=null;var k="";var e=0,p=0;var c=function(){};var f=function(r){q.fire("baiduFmClick",{clickType:r})};h.playerOpreLog=function(r){q.fire("musicUserOpt",{opType:r})};h.getLoginfo=function(s){var t=h.playerIns,r=t.logInfo;switch(s){case"position":return t.player.getCurrentPosition();break;case"channelduration":return Math.round((+(new Date())-r.channelst)/1000);break;case"fromstart":return +(new Date())-r.startTimestamp;break;case"start2play":return r.connectTimestamp-r.startTimestamp;break;case"duration":return t.player.getTotalTime();break;default:return r[s];break}};var m=function(){var r=this;this.logInfo={song_id:"",song_title:"",singer_id:"",singer_name:"",album_id:"",album_name:"",channel:"",page:"baidu_home",expoitem:"pcwidget",position:"",link:"",channelst:"",bufferCount:0,startTimestamp:0,connectTimestamp:0,auto:0,durationRaw:0};this.fmToken="";this.player=null;this.timeLeft=-1;this.lrcTimer=-1;this.timerFireTimer=-1;this.playActionUrl="http://fm.baidu.com/dev/api/?action=userop&tn=userop&";this.sendUserAction=function(s){var t={"-1":"1|3|1","2":"1|4|1","4":"1|1|1","5":"2|1|1","6":"1|2|1","3":"1|5|1"};window.sendUserActionCallback=function(){};var v="data="+t[s.no]+"|"+s.id+"|"+encodeURIComponent(n.currentChannel)+"&hashcode="+encodeURIComponent(r.fmToken);var u=r.playActionUrl+v+"&callback=sendUserActionCallback";S.sio.callByBrowser(u,function(){})};this.init=function(){q.fire("music-log-fire",{arg:"exposure"});window.packFmWriteToken=function(t){if(t&&t.hash_code){r.fmToken=t.hash_code}};S.sio.callByBrowser("http://fm.baidu.com/dev/api/?tn=usercounts&callback=packFmWriteToken&t="+ +new Date(),function(){},{charset:"utf-8"});var s=[{constructorName:"PlayEngine_FMP_MP3",args:{swfPath:"http://fm.baidu.com/static/flash/fmp_mp3.swf?_t="+(new Date().getTime()),instanceName:"baidu.packPlayer"}},{constructorName:"PlayEngine_Audio",args:{}}];baidu.packPlayer=new baidu.packfpe({el:"s_p_l_a_y_e_r",subEngines:s});r.player=baidu.packPlayer;r.player.init();r.player.setEventListener(r.player.EVENTS.STATECHANGE,function(t){if(t.newState=="error"){r.goNext(1)}if(t.newState=="end"&&t.oldState=="play"){r.goNext(1)}if(t.newState=="buffering"){r.logInfo.bufferCount++}});e=setInterval(function(){if(!r.player||!r.player.getState){return}if(r.player.getState()=="buffering"||r.player.getState()=="pre-buffer"){p++}else{if(r.player.getState()!="buffering"&&r.player.getState()!="pre-buffer"){p=0}}if(p>30){r.goNext();p=0}},1000);r.player.setEventListener(r.player.EVENTS.POSITIONCHANGE,function(t){if(t.position>=100&&r.logInfo.connectTimestamp==0){r.logInfo.connectTimestamp=+(new Date());q.fire("music-log-fire",{arg:"playsong100ms"})}});clearTimeout(r.lrcTimer);r.lrcTimer=setTimeout(function(){h.lrcShow.begin(n.playList[n.channelType][n.currentIndex].lrcLink)},300);r.player.setVolume(n.userVolume);b();r.logInfo.channelst=+(new Date());q.listen("superplus:setting/tab_mod","modOperate",function(t){if(t.id==3&&t.cmd=="del"){r.goPause()}})};this.timerFire=function(){r.playTimeListen({time:r.player.getCurrentPosition()});this.timerFireTimer=setTimeout(function(){r.timerFire()},200)};this.startTimerFire=function(){clearTimeout(r.timerFireTimer);r.timerFire()};this.endTimerFire=function(){clearTimeout(r.timerFireTimer)};this.VolumeCtrlListen=function(u){var t=Math.ceil(u.v);r.player.setVolume(t);var s="_"+s_session.portrait+"_";$.ls.set(s+"fm_cl_dv",t)};this.playTimeListen=function(s){r.drawProcessBar(s);r.showRestTime(s);r.is60s(s)};this.is60s=function(s){var t=n.playList[r.currentChannelType][r.currentChannelIndex==-1?n.currentIndex:r.currentChannelIndex];if(s.time>60*1000&&!t._60s){r.sendUserAction({id:t.song_id,no:3});h.playerOpreLog("listen60s");q.fire("music-log-fire",{arg:"60play"});t._60s=true}};this.drawProcessBar=function(s){if(r.player.getState()!="play"){return}n.modDom.processBar.css("width",s.time/1000/n.playList[n.channelType][n.currentIndex].song_time*n.processLen+"px")};this.showRestTime=function(u){if(r.player.getState()!="play"){return}var w=Math.ceil(n.playList[n.channelType][n.currentIndex].song_time-u.time/1000);if(r.timeLeft==w){return}r.timeLeft=w;if((!w&&w!=0)||w<0){return}var t=parseInt(w/60),v=w%60;t=t<10?"0"+t:t;v=v<10?"0"+v:v;n.modDom.musicTime.innerHTML="-"+t+":"+v;t=null;v=null};this.PlayBtnListen=function(s){switch(S.getAttr(s.tar,"id")){case"play-btn":switch(S.hasClass(s.tar,"pause")){case true:r.goPlay();f("playBtn");window.urSendClick=window.urSendClick||function(){};window.urSendClick({pid:"super",mod:"baidufm"});q.fire("musicClick",{opType:"playbtn"});break;case false:r.goPause();q.fire("music-log-fire",{arg:"click_pause"});q.fire("musicClick",{opType:"pausebtn"});break}break;case"love-btn":r.goLove(s);f("loveBtn");break;case"hate-btn":r.goHate();f("hateBtn");q.fire("musicClick",{opType:"hatebtn"});break;case"next-btn":q.fire("music-log-fire",{arg:"click_passsong"});r.sendUserAction({id:n.playList[r.currentChannelType][r.currentChannelIndex==-1?n.currentIndex:r.currentChannelIndex].song_id,no:2});r.goNext(0);f("nextBtn");q.fire("musicClick",{opType:"nextbtn"});break}};this.currentChannelType=0;this.currentChannelIndex=-1;this.goPlay=function(v){if(!r.logInfo.channelst){r.logInfo.channelst=(+new Date())}var u=function(){r.startTimerFire();r.player.play();r.changePlayState("pause","play","暂停")};if(!v&&r.player.getState()=="pause"){u();return}var w=n.playList[n.channelType][n.currentIndex];r.currentChannelType=n.channelType;r.currentChannelIndex=n.currentIndex;if(!w){return}var s=w.songLink;if(!s&&n.currentIndex!=n.loadIndex[n.channelType]){r.goNext(1);return}if(s&&s=="emptyLink"){r.goNext(1)}if((s&&s!=""&&s!="emptyLink")&&(+(new Date())-w.songXcodeTime<3600*1000)){r.player.setUrl(s+"&_="+new Date().getTime());h.playerOpreLog("listen");var t=r.logInfo;t.song_id=w.song_id;t.song_title=w.song_name;t.singer_id=w.singer_id;t.singer_name=w.singer_name;t.album_id=w.album_id;t.album_name=w.album_name;t.link=encodeURIComponent(w.songLink);t.startTimestamp=+(new Date());t.durationRaw=w.song_time;t.channel=n.currentChannel;t.bufferCount=0;t.connectTimestamp=0;q.fire("music-log-fire",{arg:"playstart"});u();clearTimeout(r.lrcTimer);r.lrcTimer=setTimeout(function(){h.lrcShow.begin(w.lrcLink)},300);n.renderMusicInfo(w.song_name,w.song_id,w.singer_name,w.singer_id,w.type,w.songPicBig,w.song_time)}else{if(n.loadMore){if(+(new Date())-w.songXcodeTime>3600*1000){n.loadIndex[n.channelType]=n.currentIndex}n.loadMore(r.goPlay)}}};this.changePlayState=function(t,s,v){var u=[S.children(n.modDom.musicCtrl[0])[0],S.children(n.modDom.musicCtrl[1])[0]];S.removeClass(u,t);S.addClass(u,s);S.setAttr(u,"title",v);if(v=="暂停"){S.addClass(n.modDom.musicState,"playing");if(typeof window._sp_async!="undefined"&&$("#form1")[0]){$("#form1").attr("target","_blank")}}else{S.removeClass(n.modDom.musicState,"playing");if(typeof window._sp_async!="undefined"&&$("#form1")[0]){$("#form1").attr("target",s_session.userProp.searchAgroupGuide?"_blank":"")}}S.removeClass(n.modDom.channelPnl,"chanel-pnl-"+t);S.addClass(n.modDom.channelPnl,"chanel-pnl-"+s);r.changePicRoll(v)};this.picRollAngleForIE=0;this.picRollTimerForIE=0;this.picRollForIE=function(s){if(s){clearInterval(r.picRollTimerForIE);r.picRollTimerForIE=setInterval(function(){r.picRollAngleForIE=(r.picRollAngleForIE+0.0314)%6.28;var u=r.picRollAngleForIE;var x=Math.cos(u),w=Math.sin(u),v=-119/2*x+119/2*w+119/2,t=-119/2*w-119/2*x+119/2;var y="progid:DXImageTransform.Microsoft.Matrix(DX="+v+",DY="+t+",M11="+Math.cos(u)+",M12="+Math.sin(u)*-1+",M21="+Math.sin(u)+",M22="+Math.cos(u)+")";n.modDom.picShow.css("filter",y)},40)}else{clearInterval(r.picRollTimerForIE)}};this.changePicRoll=function(s){if(S.ie&&S.ie<10){if(s=="暂停"){r.picRollForIE(true)}else{r.picRollForIE(false)}}else{n.modDom.picShow.addClass("fm-disk-animation");n.modDom.picShow.css("animation-play-state",(s=="暂停"?"running":"paused"))}};this.goPause=function(){r.player.pause();r.endTimerFire();r.changePlayState("play","pause","播放");n.modDom.picShow.removeClass("fm-disk-animation")};this.goLove=function(t){var s=t.tar,u;if(S.hasClass(s,"loved")){u=5;q.fire("music-log-fire",{arg:"click_cancelFavor"});S.removeClass(s,"loved");S.setAttr(s,"title","收藏");n.playList[n.channelType][n.currentIndex].type=-1;q.fire("musicClick",{opType:"cancellove"})}else{c();q.fire("music-log-fire",{arg:"click_singleFavor"});u=4;S.addClass(s,"loved");S.setAttr(s,"title","取消收藏");n.playList[n.channelType][n.currentIndex].type=0;q.fire("musicClick",{opType:"lovesong"})}r.sendUserAction({id:n.playList[r.currentChannelType][r.currentChannelIndex==-1?n.currentIndex:r.currentChannelIndex].song_id,no:u})};this.goHate=function(){r.sendUserAction({id:n.playList[r.currentChannelType][r.currentChannelIndex==-1?n.currentIndex:r.currentChannelIndex].song_id,no:6});q.fire("music-log-fire",{arg:"click_singleDel"});n.playList[n.channelType].splice(n.currentIndex,1);if(n.playList[n.channelType].length==0){var s="public_tuijian_suibiantingting";if(n.currentChannel!=s){n.loadReal(s)}else{n.loadReal("private")}}else{if(n.loadIndex[n.channelType]>=n.currentIndex){n.loadIndex[n.channelType]=(n.loadIndex[n.channelType]-1)%n.playList[n.channelType].length;n.loadIndex[n.channelType]=n.loadIndex[n.channelType]>=0?n.loadIndex[n.channelType]:0}n.currentIndex=(n.currentIndex-1)%n.playList[n.channelType].length;r.goNext(0)}};this.goNext=function(v){r.logInfo.auto=v||0;q.fire("music-log-fire",{arg:"playend"});h.lrcShow.end();var u=n.playList[n.channelType];if(u.length==0){return}if(n.channelType==0&&n.currentIndex==n.loadIndex[0]){n.loadIndex[0]=(n.loadIndex[0]+1)%u.length}n.currentIndex=(n.currentIndex+1)%u.length;if(u[n.currentIndex].resourceType&&u[n.currentIndex].resourceType>2){r.goNext(0);return}var t=n.currentIndex,s=n.loadIndex[n.channelType];this.goPlay(true)}};var d=function(){var r=this;this.ctrlDom=null;this.init=function(){var s=function(t){if(S.event.getTarget&&n.channelType>-1){h.playerIns.PlayBtnListen({tar:S.event.getTarget(t)})}};S.each(n.modDom.musicCtrl,function(t){S.on(t,"click",s)})}};var j=function(){var r=this;this.isMute=false;this.volume=50;this.vpnl=null;this.slider=null;this.handle=null;this.panel=null;this.isChanging=false;this.startMouseX=0;this.startHandle=0;this.rangle=100;this.handleW=10;this.showTimer=0;this.hideTimer=0;this.startShowPanel=function(){clearTimeout(r.hideTimer);r.showTimer=setTimeout(function(){$(r.panel).css("display","block");S.addClass(n.modDom.playPanel,"has-click-volume");if(S.ie&&S.ie==6){setTimeout(function(){$(r.panel.parentNode).toggleClass("-refresh-for-ie6")},10)}},0)};this.startHidePanel=function(){clearTimeout(r.showTimer);r.hideTimer=setTimeout(function(){$(r.panel).css("display","");S.removeClass(n.modDom.playPanel,"has-click-volume")},0)};this.init=function(){r.content=n.modDom.volumeCtrl;r.muteBtn=S.q("mute",r.content)[0];r.volumeOpen=S.q("volume-open",r.content)[0];r.slider=S.q("slider",r.content)[0];r.handle=S.q("handle",r.content)[0];r.panel=S.q("volume-panel",r.content)[0];r.rangle=parseInt(S.getStyle(S.q("volume-panel",r.content)[0],"height").replace(/px$/g,""));r.handleW=parseInt(S.getStyle(r.handle,"height").replace(/px$/g,""));r.startHandle=parseInt(S.getStyle(r.handle,"bottom").replace(/px$/g,""));S.on(r.volumeOpen,"click",function(s){S.event.stop(s);r.startShowPanel()});S.on(r.muteBtn,"click",function(s){S.event.stop(s)});S.on(r.panel,"click",function(s){S.event.stop(s)});S.on(document.body,"click",function(s){r.startHidePanel()});S.on(r.handle,"mousedown",function(s){S.event.preventDefault(s);r.startChange(s)});S.on(r.handle,"mouseup",function(s){r.endChange(s)});S.on(r.handle,"click",function(s){S.event.stop(s)});S.on(document,"mouseup",function(s){r.endChange(s)});S.on(r.content,"mouseleave",function(s){r.endChange(s)});S.on(r.content,"mousemove",function(s){S.event.preventDefault(s);if(r.isChanging){r.changIng(s)}});S.on(r.panel,"click",function(t){var s=t.srcElement||t.target;var u=t.offsetY||t.layerY||t.originalEvent.layerY;u=(s==r.panel)?(r.rangle+8-u):(r.startHandle-u);if(u<r.handleW/2){u=r.handleW/2}else{if(u>r.rangle-r.handleW/2){u=r.rangle-r.handleW/2}}r.startHandle=u;r.setVolume();r.setPosition(r.startHandle,r.startHandle/r.rangle*100)});S.on(r.muteBtn,"click",function(){h.playerIns.VolumeCtrlListen({v:0});r.setMuted(r.isMute)});$(".s-xman-baidu-fm .download-btn").on("click",function(){q.fire("musicClick",{opType:"downloadbtn"})});$(".s-xman-baidu-fm .s-name").on("click",function(){q.fire("musicClick",{opType:"songname"})});$(".s-xman-baidu-fm .s-author").on("click",function(){q.fire("musicClick",{opType:"singername"})})};this.setMuted=function(s){if(!s){r.isMute=true;S.addClass(n.modDom.volumeCtrl,"volume-muted");S.setAttr(r.muteBtn,"title","取消静音");r.setPosition(r.handleW/2,(r.handleW/r.rangle/2)*100)}else{if(r.volume==0){return}r.isMute=false;h.playerIns.VolumeCtrlListen({v:r.volume});S.removeClass(n.modDom.volumeCtrl,"volume-muted");S.setAttr(r.muteBtn,"title","静音");r.setPosition(r.startHandle,(r.startHandle/r.rangle)*100)}};this.startChange=function(s){r.isChanging=true;this.startMouseY=s.clientY;this.startHandle=parseInt(S.getStyle(r.handle,"bottom").replace(/px$/g,""))};this.endChange=function(s){if(!r.isChanging){return}r.isChanging=false};this.changIng=function(t){var u=t.clientY;var s=this.startHandle+(this.startMouseY-u);if(s<r.handleW/2){s=r.handleW/2}else{if(s>r.rangle-r.handleW/2){s=r.rangle-r.handleW/2}}this.startHandle=s;this.startMouseY=u;this.setPosition(s,s/r.rangle*100);this.setVolume()};this.setVolume=function(){r.volume=Math.ceil(this.startHandle-r.handleW/2)/(r.rangle-r.handleW)*100;if(r.volume==0){r.setMuted(r.isMute)}else{if(r.isMute){r.setMuted(r.isMute)}}h.playerIns.VolumeCtrlListen({v:r.volume})};this.setPosition=function(t,s){S.setStyle(r.handle,"bottom",t+"px");S.setStyle(r.slider,"height",s+"%")}};var o=function(){var r=this;this.listDom=null;this.callback=null;this.panel=null;this.btn=null;this.init=function(u,t,s){r.pnl=u;r.btn=t;r.listDom=S.q("bd-fm-list",u);r.callback=s;r.initCurrent(n.currentChannel);r.initClickEvent()};this.initClickEvent=function(){S.each(r.listDom,function(s){S.on(s,"click",function(t){q.fire("musicClick",{opType:"ccbtn"});if(S.hasClass(s,"current-ch")){return}else{f("changeChannel");h.playerOpreLog("changechannel");n.loadReal(S.getAttr(s,"channel_id"));r.callback({p:r.pnl,b:r.btn,top:-200,text:"换台"})}})})};this.changeCurrent=function(s){S.removeClass(S.q("current-ch",r.pnl)[0],"current-ch");r.initCurrent(s)};this.initCurrent=function(s){S.each(r.listDom,function(t){if(S.getAttr(t,"channel_id")==s){S.addClass(t,"current-ch")}})}};var b=function(){window.packSongsLoadMore=function(s){if(s.errorCode!=22000){return}var r=s.data.songList;var t=r[0].songId,u=r.length;q.use("mods_extend/baidu_fm_mod_extend",function(A){var v=A.mod,w=v.playList[v.channelType];var z=w.length;var x;for(var y=0;y<z;y++){if(w[y].song_id==t){x=y;break}}for(var y=0;y<u;y++){if(r[y].songLink&&r[y].songLink!=""&&r[y].songLink.toLowerCase().indexOf("xcode=")<0){r[y].songLink=r[y].songLink+"?xcode="+s.data.xcode}S.extend(w[(x+y)%w.length],{songLink:r[y].songLink,lrcLink:r[y].lrcLink,singer_id:r[y].artistId,song_id:r[y].songId,song_name:r[y].songName,singer_name:r[y].artistName,song_time:r[y].time,album_id:r[y].albumId,album_name:r[y].albumName,resourceType:r[y].resourceType,songPicBig:r[y].songPicBig,songXcodeTime:+(new Date())});if(!w[(x+y)%w.length].songLink){w[(x+y)%w.length].songLink="emptyLink"}}})};window.packSongsLoadReal=function(s){if(s.status!=0||s.list.length==0){return}var u=s.list;for(var t=0;t<u.length-1;t++){for(var r=t+1;r<u.length;r++){if(u[t].id==u[r].id){u.splice(r,1)}}}q.use("mods_extend/baidu_fm_mod_extend",function(x){var v=x.mod;var w=v.playList[1]=[];if(v.currentChannel!=s.channel_id){v.changeSuc=true;v.currentChannelName=s.channel_name;v.currentChannel=s.channel_id}S.each(u,function(y){w.push({song_id:y.id,type:y.type,songLink:"",lrcLink:"",singer_id:"",song_name:"",singer_name:""})})})};S.extend(n,{detailUrl:"http://music.baidu.com/data/music/fmlink?songIds=",playListApi:"http://fm.baidu.com/dev/api/?tn=playlist&special=flash&format=json&id=",loadMore:function(r){if(this.isLoading){return}this.isLoading=true;var v="";var t=this.loadIndex[this.channelType];for(var u=0;u<10;u++){var w=this.playList[this.channelType][this.loadIndex[this.channelType]];v+=(w.song_id+",");this.loadIndex[this.channelType]=(this.loadIndex[this.channelType]+1)%this.playList[this.channelType].length}v=v.replace(/,$/g,"");if(v==""){this.isLoading=false;return}var s=this;k=this.detailUrl+v;S.sio.callByBrowser(this.detailUrl+v+"&callback=packSongsLoadMore&_="+new Date().getTime(),function(){s.isLoading=false;r&&r();if(s.channelType==0&&!s.loadRealState){s.loadRealState=true;s.loadReal()}},{charset:"utf-8",timeOut:5000,onfailure:function(){s.isLoading=false;s.loadIndex[s.channelType]=t;s.loadMore(r)}})},loadReal:function(u){if(this.isLoading){return}this.isLoading=true;var t=u||this.currentChannel,r=this;var s=function(w,v){h.playerIns.logInfo.channelst=+(new Date());r.loadIndex[1]=r.currentIndex=w;r.loadMore(v)};S.sio.callByBrowser(this.playListApi+t+"&callback=packSongsLoadReal&_="+new Date().getTime(),function(){r.isLoading=false;if(!r.changeSuc&&u=="lovesongs"){q.fire("user-has-no-lovesongs")}if(r.changeSuc){q.fire("music-log-fire",{arg:"click_channel"});r.changeSuc=false;h.playerIns.player.stop();h.changePnl.changeCurrent(u);baidu.packFmCurrentChannel=u;r.channelType=1;s(0,h.playerIns.goPlay);var v="_"+s_session.portrait+"_";$.ls.set(v+"fm_cl",r.currentChannel);$.ls.set(v+"fm_cl_name",r.currentChannelName)}else{if(r.channelType==0&&r.playList.length>1&&r.playList[1].length>0){r.channelType=1;s(0)}}},{charset:"utf-8",timeOut:5000,onfailure:function(){r.isLoading=false;r.loadReal(u)}})}})};var l=function(){var r=this;this.container=null;this.lrcElmList=[];this.currentLrc=null;this.lrcList=[];this.lrcTop=[];this.isNew=false;this.loadUrl=s_domain.baseuri+"/pack/data/fmlrc?qstr=";this.state=-1;this.updateTimer=-1;this.currentLrcPos=-1;this.lrcContent=null;this.allowMoving=true;this.isMoving=false;this.TOKEN_REGEXP=/\[(.*?)\](.*?)(?=(\[|$))/igm,this.lrcElmSortFunc=function(t,s){if(t.time==s.time){return 0}return t.time>s.time?1:-1},this.init=function(s){q.listen("superplus:skeleton/skeleton_ext","viewChange",function(t){if(t.to==3){r.begin(r.currentLrc,true)}});r.currentLrcPos=-1;r.isNew=s;r.container=S.q("lrc-wrap",n.modDom.lrcPanel)[0];r.lrcContent=S.g("lrc_content")};this.end=function(){clearTimeout(r.updateTimer);r.allowMoving=false;r.lrcContent.innerHTML=""};this.begin=function(s,u){if(r.currentLrc==s&&!u){return}r.currentLrc=s;clearTimeout(r.updateTimer);r.state=-1;r.currentLrcPos=-1;r.lrcContent.innerHTML="";r.allowMoving=false;S.setStyles(r.lrcContent,{top:"0px","margin-left":"0px"});r.lrcContent.innerHTML="";var v=S.q("lrc-info",n.modDom.lrcPanel)[0];$(v).css("display","none");var t=function(){$(v).css("display","block");v.innerHTML="抱歉，此歌曲暂无歌词";r.lrcContent.innerHTML="";clearTimeout(r.updateTimer);h.lrcScroll.refresh()};if(!s){t();return}S.ajax.get(r.loadUrl+encodeURIComponent(s),function(w){if(!w||w.errNo!=0||w.data.errcode!=0){t();return}v.innerHTML="";r.lrcTrans(w.data.lrc);h.lrcScroll.refresh()})};this.lrcTrans=function(z){var y=z.replace(/\n|\r/gmi," "),u={},w=[],A=[],v=0,t=0,x=0;r.lrcList=[];r.TOKEN_REGEXP.lastIndex=0;if(!r.TOKEN_REGEXP.test(y)){var s=y.split(" ");for(var x=0;x<s.length;x++){r.lrcList.push({time:x*10000000000,content:s[x]})}}else{while(u=r.TOKEN_REGEXP.exec(y)){w=u[1].split(":");switch(w[0]){case"al":case"ar":case"by":case"re":case"ti":case"ve":break;case"offset":v=parseInt(w[1]);break}if(!(/^\d+$/i.test(w[0]))){continue}t=(parseInt(u[1].substr(0,2))*60+parseFloat(u[1].substring(3)))*1000-v;if(u[2]==" "){u[2]="   "}r.lrcList.push({time:t,content:u[2]});x=r.lrcList.length-1;while(x--){if(r.lrcList[x].content==""){r.lrcList[x].content=u[2]}if(r.lrcList[x].time>t&&r.lrcList[x].content==" "){r.lrcList[x].content=u[2]}}}r.lrcList=r.lrcList.sort(r.lrcElmSortFunc);if(r.lrcList.length==0){r.lrcList.push({time:2100000000,content:y})}}r.fillHTML();h.lrcScroll.refresh()};this.fillHTML=function(){r.lrcElmList=[];r.lrcContent.innerHTML="";var y,w,t=r.lrcList.length;var s="";var v="<li id='lyrics_li_#{id}' >#{content}</li>",x=[];for(var w=0;w<t;w++){x.push(S.format(v,{id:w,content:r.lrcList[w].content}))}$(r.lrcContent).append(s+x.join("")+s);var u=S.getPosition(S.q("lrc-wrap",n.modDom.lrcPanel)[0]);r.lrcTop=[];for(var w=0;w<t;w++){y=S.g("lyrics_li_"+w);r.lrcTop.push(S.getPosition(y).top-u.top);r.lrcElmList.push(y)}r.state=0;r.startTimer()};r.startTimer=function(){r.updatePos();r.updateTimer=setTimeout(function(){r.startTimer()},300)};r.updatePos=function(){if(r.state==-1){clearTimeout(r.updateTimer);return}try{var t=h.playerIns.player.getCurrentPosition()||"-1"}catch(w){var t=-1}var u=r.findLrcIndexByTime(t);if(t=="-1"){clearTimeout(r.updateTimer);return}if(u==r.currentLrcPos){return}if(!r.isMoving){r.allowMoving=true}r.currentLrcPos=u;r.hightline(u);var v=48-r.lrcTop[u],s=parseInt(S.getStyle(r.lrcContent,"top").replace(/px$/g,""));if(s<v&&u<2){q.fire("lrcAutoScrollEnd",{top:v});return}if(h.lrcScroll.userIsUsing){return}r.isMoving=true;$(r.lrcContent).css("top",s+"px");$(r.lrcContent).animate({top:v},{duration:400,complete:function(){q.fire("lrcAutoScrollEnd",{top:v});r.isMoving=false},step:function(x,y){if(r.allowMoving){$(r.lrcContent).css("top",x)}}});t=null;u=null};r.hightline=function(s){var t=S.q("current",r.container)[0];if(t){S.removeClass(t,"current")}S.addClass(r.lrcElmList[s],"current");t=null};r.findLrcIndexByTime=function(t){var s=r.lrcList.length;while(s--&&r.lrcList[s]["time"]>t){}return Math.min(Math.max(s,0),r.lrcList.length-1);s=null}};var i=function(){var r=this;this.init=function(s){S.each(s,function(t){if(t.arg!="lrcLabel"){S.on(t.dom,"click",function(){f(t.arg)})}else{S.on(t.dom,"click",function(){if(S.hasClass(t.dom,"lrc-label-show")){f("lrcHide")}else{f("lrcShow")}})}})}};var a=function(){var r=this;this.panel=null;this.range=0;this.slider=null;this.lrcWrap=null;this.lrcContent=null;this.lrcWrapHeight=0;this.lrcContentHeight=0;this.sliderHeight=0;this.sliderTop=0;this.userIsUsing=false;this.refresh=function(){r.lrcContentHeight=parseInt(r.lrcContent.css("height").replace(/px$/g,""));r.sliderTop=0;r.refreshView();if(r.lrcContentHeight<100){r.panel.css("display","none")}else{r.panel.css("display","block")}};this.refreshView=function(){r.sliderTo();r.rollTo()};this.writeSliderTop=function(s){r.sliderTop=s;if(s<0){r.sliderTop=0}else{if(s>r.range){r.sliderTop=r.range}}};this.rollTo=function(){var s=-1*(r.sliderTop/r.range*(r.lrcContentHeight-100));r.lrcContent.css("top",s+"px")};this.sliderTo=function(){r.slider.css("top",(r.sliderTop-1)+"px")};this.bindEvent=function(){S.on(r.panel,"click",function(s){r.userIsUsing=true;var t=s.offsetY||s.layerY||s.originalEvent.layerY;r.writeSliderTop(t-r.sliderHeight/2);r.refreshView()});S.on(r.panel,"mouseenter",function(s){S.addClass(r.panel,"lrc-scroll-ctrl-hover")});S.on(r.panel,"mouseleave",function(s){if(r.isDraging){return}S.removeClass(r.panel,"lrc-scroll-ctrl-hover")});S.on(r.slider,"click",function(s){S.addClass(r.panel,"lrc-scroll-ctrl-hover");S.event.stop(s)});S.on(r.slider,"mousedown",function(s){S.event.preventDefault(s);r.startDrag(s)});S.on(r.lrcWrap,"mouseleave",function(s){r.userIsUsing=false});S.on(S.g("s_content_3"),"mouseup",function(s){r.endDrag(s)});S.on(S.g("s_content_3"),"mouseleave",function(s){r.endDrag(s)});S.on(r.lrcWrap,"DOMMouseScroll",r.mousewheelLister);S.on(r.lrcWrap,"mousewheel",r.mousewheelLister)};this.opera=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(navigator.userAgent)?+(RegExp["\x246"]||RegExp["\x242"]):undefined;this.getDelta=function(t){var s=t.originalEvent;if(s.wheelDelta){return(r.opera&&r.opera<9.5?-s.wheelDelta:s.wheelDelta)}else{if(s.detail){return -s.detail*40}else{if($.isIE){return -s.deltaY}else{return -s.deltaY*40}}}};this.mousewheelListerTimer=0;this.mousewheelLister=function(s){r.userIsUsing=true;S.event.stop(s);var t=r.getDelta(s);if(t!=0){clearTimeout(r.mousewheelListerTimer);r.mousewheelListerTimer=setTimeout(function(){h.playerOpreLog("scrolllrc")},500)}r.writeSliderTop(r.sliderTop+50*(-1*t)/r.lrcContentHeight);r.refreshView()};this.startPos=0;this.isDraging;this.startDrag=function(s){r.userIsUsing=true;r.startPos=s.clientY;r.isDraging=true;S.on(S.g("s_content_3"),"mousemove",function(t){S.event.preventDefault(t);r.dragIng(t)})};this.dragIng=function(t){if(!r.isDraging){return}r.userIsUsing=true;var s=t.clientY;r.writeSliderTop(r.sliderTop+(s-r.startPos));r.startPos=s;r.refreshView()};this.endDrag=function(s){if(r.isDraging==true){h.playerOpreLog("scrolllrc")}r.isDraging=false;S.removeClass(r.panel,"lrc-scroll-ctrl-hover");$("#s_content_3").unbind("mousemove")};this.init=function(){r.panel=n.modDom.lrcScrollPanel;r.slider=n.modDom.lrcScrollSlider;r.lrcWrap=$(h.lrcShow.container);if($.browser.ie==8){$("#s_content_3").css("background","#fff").css("filter","alpha(opacity=0)")}r.lrcContent=$(h.lrcShow.lrcContent);r.lrcWrapHeight=113;r.sliderHeight=17;r.range=113-r.sliderHeight;r.bindEvent();q.listen("musicplus:mods_extend/baidu_fm_player","lrcAutoScrollEnd",function(s){if(r.userIsUsing){return}var t=s.top;(t>0)&&(t=0);r.writeSliderTop(-t/r.lrcContentHeight*r.range);r.sliderTo()})}};h.playerIns=new m();h.playerCtrl=new d();h.volumeCtrl=new j();h.changePnl=new o();h.lrcShow=new l();h.playerCLog=new i();h.lrcScroll=new a()});F.module("musicplus:mods_extend/baidu_fm_channel_panel",function(c,b,a){var d=[{channel_id:"private",channel_name:"私人频道"},{channel_id:"lovesongs",channel_name:"红心频道"},{channel_id:"public_tuijian_suibiantingting",channel_name:"随便听听"},{channel_id:"public_yuzhong_oumei",channel_name:"欧美"},{channel_id:"public_shiguang_jingdianlaoge",channel_name:"经典老歌"},{channel_id:"public_fengge_dj",channel_name:"DJ舞曲"},{channel_id:"public_tuijian_rege",channel_name:"热歌"},{channel_id:"public_tuijian_wangluo",channel_name:"网络红歌"},{channel_id:"public_tuijian_chengmingqu",channel_name:"成名曲"},{channel_id:"public_shiguang_xinge",channel_name:"火爆新歌"},{channel_id:"public_fengge_liuxing",channel_name:"流行"},{channel_id:"public_xinqing_huankuai",channel_name:"快乐旋律"},{channel_id:"public_tuijian_ktv",channel_name:"KTV金曲"},{channel_id:"public_xinqing_shanggan",channel_name:"伤感调频"},{channel_id:"public_shiguang_80hou",channel_name:"80后"},{channel_id:"public_shiguang_90hou",channel_name:"90后"}];b.html=(function(){var f="<div class='title'>热门频道</div><div class='bd-fmjs-ccpnl'>#{listArr}</div>";var e=[];var g=0;S.each(d,function(h){g++;h.stateDefault=h.channel_id;e.push("<a style='"+((g%2==0)?("margin-right:0px;"):"")+"' href='#' onclick='return false' hidefocus class='bd-fm-list "+h.stateDefault+"' channel_id='"+h.channel_id+"'><span class='bd-fm-list-icon'>"+h.channel_name+"</span></a>")});return S.format(f,{listArr:e.join("")})})()});F.module("musicplus:start/music_start",function(e,c,a){e("music_fm.css");var f=f||{},b=!!s_session.sample_value;f._createScriptTag=function(h,g,i){h.setAttribute("type","text/javascript");i&&h.setAttribute("charset",i);h.setAttribute("src",g);document.getElementsByTagName("head")[0].appendChild(h)};f._removeScriptTag=function(h){if(h.clearAttributes){h.clearAttributes()}else{for(var g in h){if(g!=="nodeName"&&g!=="parentNode"&&h.hasOwnProperty(g)){delete h[g]}}}if(h&&h.parentNode){h.parentNode.removeChild(h)}h=null};f.callByBrowser=function(g,m,o){var j=document.createElement("SCRIPT"),k=0,p=o||{},i=p.charset,n=m||function(){},l=p.timeOut||0,h;j.onload=j.onreadystatechange=function(){if(k){return}var q=j.readyState;if("undefined"==typeof q||q=="loaded"||q=="complete"){k=1;try{n();clearTimeout(h)}finally{j.onload=j.onreadystatechange=null;f._removeScriptTag(j)}}};if(l){h=setTimeout(function(){j.onload=j.onreadystatechange=null;f._removeScriptTag(j);p.onfailure&&p.onfailure()},l)}f._createScriptTag(j,g,i)};window.S=window.S||{};window.baidu=window.baidu||{};(function(){var g=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g");S.trim=function(h){return String(h).replace(g,"")}})();S.escapeReg=function(g){return String(g).replace(new RegExp("([.*+?^=!:\x24{}()|[\\]/\\\\])","g"),"\\\x241")};S.url={};S.url.jsonToQuery=function(k,i){var h=[],j,g=i||function(l){return baidu.url.escapeSymbol(l)};S.each(k,function(l,m){if(baidu.lang.isArray(l)){j=l.length;while(j--){h.push(m+"="+g(l[j],m))}}else{h.push(m+"="+g(l,m))}});return h.join("&")};S.jsonToQuery=function(g){return S.url.jsonToQuery(g,function(h){return window.encodeURIComponent(h)})};S.on=function(i,g,h){$(i).on(g,h)};S.event=S.event||{};S.event.stopPropagation=function(g){if(g.stopPropagation){g.stopPropagation()}else{g.cancelBubble=true}};S.event.preventDefault=function(g){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}};S.event.stop=function(g){S.event.stopPropagation(g);S.event.preventDefault(g)};S.event.getTarget=function(g){return g.target||g.srcElement};S.getAttr=function(h,g){return $(h).attr(g)};S.setAttr=function(i,g,h){return $(i).attr(g,h)};S.getStyle=function(h,g){return $(h).css(g)};S.ajax=S.ajax||{};S.ajax.get=$.ajaxget;S.setStyle=function(i,g,h){return $(i).css(g,h)};S.setStyles=function(g,i){g=S.g(g);for(var h in i){S.setStyle(g,h,i[h])}return g};S.sio=S.sio||{};S.sio.callByBrowser=f.callByBrowser;S.addClass=function(h,g){return $(h).addClass(g)};S.removeClass=function(h,g){return $(h).removeClass(g)};S.hasClass=function(h,g){return $(h).hasClass(g)};S.extend=function(i,g){for(var h in g){if(g.hasOwnProperty(h)){i[h]=g[h]}}return i};S.getPosition=function(g){return $(g).position()};S.children=function(g){g=S.g(g);for(var h=[],i=g.firstChild;i;i=i.nextSibling){if(i.nodeType==1){h.push(i)}}return h};S.format=$.formatString;S.each=function(k,m,h){var n,l,o,i=k.length;if("function"==typeof m){for(o=0;o<i;o++){l=k[o];n=m.call(h||k,l,o);if(n===false){break}}}return k};S.g=function(g){if(!g){return null}if("string"==typeof g||g instanceof String){return document.getElementById(g)}else{if(g.nodeName&&(g.nodeType==1||g.nodeType==9)){return g}}return null};S.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?(document.documentMode||+RegExp["\x241"]):undefined;S.q=function(o,l,h){var p=[],k=S.trim,n,m,g,j;if(!(o=k(o))){return p}if("undefined"==typeof l){l=document}else{l=S.g(l);if(!l){return p}}h&&(h=k(h).toUpperCase());if(l.getElementsByClassName){g=l.getElementsByClassName(o);n=g.length;for(m=0;m<n;m++){j=g[m];if(h&&j.tagName!=h){continue}p[p.length]=j}}else{o=new RegExp("(^|\\s)"+S.escapeReg(o)+"(\\s|\x24)");g=h?l.getElementsByTagName(h):(l.all||l.getElementsByTagName("*"));n=g.length;for(m=0;m<n;m++){j=g[m];o.test(j.className)&&(p[p.length]=j)}}return p};var d=3;c.init=function(){F.use("musicplus:mngr/fm_data",function(g){g.getData(function(h){a.use("view/fm_view",function(i){i.init("s_content_3",h)});a.use("mods/baidu_fm",function(i){i.init("s_content_3",h);if(!b){F.call("superplus:skeleton/skeleton","changeTo",d)}else{F.call("superplus:skeleton/skeleton","sendLoadTime",d)}})})})}});F.call("musicplus:start/music_start","init");